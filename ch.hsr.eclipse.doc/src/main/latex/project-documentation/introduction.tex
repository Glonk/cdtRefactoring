\chapter{Introduction}
\thispagestyle{fancy}

\section{The current situation}

The Eclipse Java Development Toolkit (JDT) has a large set of both quick and
useful refactorings. Its sibling the C++ Development Toolkit (CDT) offers just a
small range of such code helpers today. In addition, some of them don't work
satisfyingly: Currenty, extracting the body of a hello world function takes more
than three seconds on our machines. Reliability? Try to \texttt{extract
constant} the hello world string of the same program. At the time of this 
writing, this still fails.

Many bachelor students at HSR visit a C++ programming class and are using 
Eclipse to solve the exercises. After a while it was clear that
touching the refactoring buttons was a dangerous action because in some cases
descibed above they broke your code. Compile errors all over the place and
difficult exercise assignments didn't make our life easier.

One annoying problem in C++ is the separation of the source and the header
files. This is a pain point for every programmer. Forgetting to update the
function signature in one of the files will result in compilation error which
causes either lack of understanding for beginners or loss of time.

After two minutes of compile error hunting because you forgot to change a
function signature in both, the header and the implementation file, you start
asking yourself: Why nobody has yet implemented a solution to prevent such an
error?

The IFS Institute for Software at HSR with its group around Professor Peter
Sommerlad and
Emanuel Graf has been working on Eclipse refactorings for a long time. Since
2006 nine Eclipse refactoring projects have been completed.

\section{What has been planned}

During this semester thesis it was planned to introduce and improve one or more
refactorings to the Eclipse CDT project. They will now be introduced by 
priority.

\subsection{\textit{Toggle Function Definition}}
The goal of this refactoring is to automate the process of moving the definition 
of a function from one place to another as shown in figures \ref{exA} and \ref{exB}:

\begin{figure}[h]
\begin{lstlisting}[language=C++]
#ifndef EXAMPLE_H
#define EXAMPLE_H

class ClearClass {
  void bigfunction() {
    /* implementation */
  }
};

#endif
\end{lstlisting}
\setlength{\abovecaptionskip}{-20pt}
\caption{Initial situation: member function defined inside a class}
\label{exA}
\end{figure}

\begin{figure}[h]
\begin{lstlisting}[language=C++]
#ifndef EXAMPLE_H
#define EXAMPLE_H

class ClearClass {
  void bigfunction();
};

void ClearClass::bigfunction {
  /* implementation */
}

#endif
\end{lstlisting}
\setlength{\abovecaptionskip}{-20pt}
\caption{Situation after toggling: member function defined separately, outside 
the class}
\label{exB}
\end{figure}

The example shows that moving the function body does not only involve copying 
code but also adds a scope operator \textit{::} to the new definition. Also, the 
former definition had to be replaced by a plain declaration. There are several 
such changes required depending on the scope and properties (static, virtual, 
etc.) of the function. Toggling multiple times should bring the code back to the 
original position in almost no time. 

Throughout this documentation, this functionality is referred to as being a 
refactoring as it uses the refactoring facility of the Eclipse LTK
\footnote{http://www.eclipse.org/articles/Article-LTK/ltk.html}. However, 
\textit{Toggle Function Definition} actually is a code generator. The idea for 
this ''refactoring'' was introduced by project advisor Prof. Peter Sommerlad.

Goal of this thesis is to realize this idea in form of an Eclipse plugin and to 
make it fast enough to become a good alternative to editing the files manually. 

\subsection{\textit{Implement Member Function}}
The current CDT plug-in already includes a \textit{Implement Member Function}.
However, it is slow and does not fit together with the newly created 
\textit{Toggle Function Definition}. It breaks the coding flow for adding 
functionality to classes with unneccessary wizards, which could be a reason not 
to use the new toggle functionality subsequently. This code generator shall 
support \textit{Toggle Function Definition} by providing a quick way to create a 
new function given an existing declaration.

Depending on the success of the implementation with the first refactoring, it is 
planned to re-implement the \textit{Implement Function} refactoring.

\subsection{\textit{Override virtual member function}}
This code genrator may share some functionality with the above ones. Its goal is 
to help the user override multiple member functions of an inherited class.

\section{Objectives}

These are the basic aims for the project:
\begin{itemize}
 \item Toggling between \texttt{in-class}, \texttt{in-header},
\texttt{separate-file} and back again to \texttt{in-class} works for basic and
some frequent special cases.
 \item Project organization: Fixed one-week iterations are used. Redmine is used
for planning and tracking time, issue tracking and as information radiator for
the supervisor. A project documentation is written. Organization and results are
reviewed weekly together with the supervisor.
 \item Quality: Common cases are covered with test cases for each
refactoring subtype.
 \item Integration and Automation: Sitting in front of a fresh Eclipse CDT
installation a first semester student can install our refactoring using an
update site as long as the functionality is not integrated into the main CDT
plug-in.
 \item To minimize the integration overhead with CDT it will be worked closely
with Emanuel Graf as he is a CDT commiter.
 \item At the end the project will be handed to the supervisor with two CD's and
two paper versions of the documentation. An update site is created where the
functionality can be added to Eclipse. A website describes in short the
functionality and our project vision.
\end{itemize}

\subsection{Advanced objectives}
All basic goals have been archived. Additionally:\newline
\begin{itemize}
 \item Toggling function is fast. less than a second.
\end{itemize}

Re-Implement the ``Implement Function'' feature.
\begin{itemize}
 \item A new function block is created with nearly no delay right below the
function signature.
 \item A default return statement is created when the block is created.
 \item If the return statement cannot be determined, a comment is inserted into
the block.
\end{itemize}

\subsection{Further objectives and outlook}

If there is enough time an \textit{Override Virtual Function} is implemented.
Additionally, content assist can be implemented. This could be part of a
bachelor thesis which continues and completes the work done in this semester
thesis.

\section{Expected outcome}

Implement member function and the toggle key are written to work in synergy.
First write the declaration for a (member) function in the header or class
definition, then a hot-key is used to implement the function. At this point the
toggle key can be hit at any time to move the function to the appropriate
position and continue with the next new member function.

\section{Project duration}
The semester thesis starts on September 20th and has to be finished until
December 23rd, 2010.

